<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Koncertszervez≈ë - Keleti Reform</title>
<style>
  body {
    background-color: #121212;
    color: #e0e0e0;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 0;
  }
  h1 {
    text-align: center;
    color: #4da6ff;
    margin: 20px 0;
  }
  .logo-header {
    text-align: center;
    padding: 20px;
    background: linear-gradient(45deg, #17acca, #262df1);
  }
  .logo-header img {
    width: 200px;
    margin-bottom: 10px;
    border-radius: 10px;
  }
  .container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    padding: 20px;
  }
  .list, .setlist {
    background-color: #1e1e1e;
    border: 1px solid #4da6ff;
    border-radius: 12px;
    padding: 15px;
    width: 320px;
    min-height: 400px;
    margin: 10px;
    box-shadow: 0 0 10px rgba(77, 166, 255, 0.3);
  }
  .list h2, .setlist h2 {
    text-align: center;
    color: #b299ff;
  }
  .song {
    padding: 8px 10px;
    margin: 5px 0;
    background-color: #2a2a2a;
    border-radius: 6px;
    cursor: grab;
    transition: background 0.2s;
  }
  .song:hover {
    background-color: #333;
  }
  .song.dragging {
    opacity: 0.6;
  }
  .setlist .song-placeholder {
    background-color: #2e2e2e;
    border: 2px dashed #4da6ff;
    height: 40px;
    margin: 5px 0;
    border-radius: 6px;
  }
  button {
    background-color: #4da6ff;
    border: none;
    color: #121212;
    padding: 8px 12px;
    margin: 10px auto;
    display: block;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
  }
  button:hover {
    background-color: #66b3ff;
  }
  .summary {
    text-align: center;
    margin-top: 10px;
    color: #ffcc66;
  }
</style>
</head>
<body>

<div class="logo-header">
  <img src="https://drive.google.com/thumbnail?id=1aaPOxP4OkfsfMd8t3QcSAI5TIx5YN4pl&sz=800" alt="Keleti Reform Logo">
  <h1>Koncertszervez≈ë</h1>
</div>

<div class="container">
  <div class="list">
    <h2>Dalok</h2>
    <div id="songList"></div>
  </div>
  <div class="setlist">
    <h2>Setlist</h2>
    <div id="setList"></div>
    <button id="addSlot">+ Hely hozz√°ad√°sa</button>
    <div class="summary" id="summary">√ñsszesen: 0 dal, 0:00</div>
  </div>
</div>

<script>
const songList = document.getElementById('songList');
const setList = document.getElementById('setList');
const summary = document.getElementById('summary');
const addSlotBtn = document.getElementById('addSlot');

function createSongElement(song) {
  const div = document.createElement('div');
  div.className = 'song';
  div.draggable = true;

  // Alap sz√∂veg
  let text = `${song.name} (${song.time})`;

  // Fuvola ikon
  if (song.flute === "normal") text += " üéµ";       // fuvola emoji
  if (song.flute === "high") text += " üéµ‚¨ÜÔ∏è";        // fuvola + felfel√© ny√≠l

  div.innerText = text;
  div.dataset.time = song.time;
  
  div.addEventListener('dragstart', e => {
    e.dataTransfer.setData('text/plain', JSON.stringify(song));
    setTimeout(() => div.classList.add('dragging'), 0);
  });
  div.addEventListener('dragend', e => div.classList.remove('dragging'));
  
  return div;
}

function createPlaceholder() {
  const div = document.createElement('div');
  div.className = 'song-placeholder';
  
  div.addEventListener('dragover', e => e.preventDefault());
  div.addEventListener('drop', e => {
    e.preventDefault();
    const data = JSON.parse(e.dataTransfer.getData('text/plain'));
    const songDiv = createSongElement(data);
    setList.replaceChild(songDiv, div);
    updateSummary();
  });
  
  return div;
}

function updateSummary() {
  const songsInSet = Array.from(setList.children)
    .filter(c => c.classList.contains('song'));
  let totalSeconds = 0;
  songsInSet.forEach(s => {
    const [min, sec] = s.dataset.time.split(':').map(Number);
    totalSeconds += min * 60 + sec;
  });
  const minutes = Math.floor(totalSeconds / 60);
  const seconds = totalSeconds % 60;
  summary.innerText = `√ñsszesen: ${songsInSet.length} dal, ${minutes}:${seconds.toString().padStart(2,'0')}`;
}

// JSON bet√∂lt√©se
fetch('songs.json')
  .then(response => response.json())
  .then(data => {
    data.forEach(song => songList.appendChild(createSongElement(song)));
  })
  .catch(err => console.error('Hiba a dalok bet√∂lt√©s√©n√©l:', err));

// Setlist inicializ√°l√°sa
for(let i=0;i<5;i++) setList.appendChild(createPlaceholder());

addSlotBtn.addEventListener('click', () => {
  setList.appendChild(createPlaceholder());
});
</script>

</body>
</html>
