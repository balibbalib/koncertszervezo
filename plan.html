<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Esem√©nytervez≈ë - Keleti Reform</title>
<style>
  body {
    background-color: #0d0d0d;
    color: #e0e0e0;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 0;
  }

  .logo-header {
    text-align: center;
    padding: 25px 10px;
    background: linear-gradient(45deg, #1782ca, #2935f1);
  }

  .logo-header img {
    width: 160px;
    margin-bottom: 10px;
    border-radius: 10px;
  }

  h1 {
    text-align: center;
    color: #b3d9ff;
    margin: 10px 0;
  }

  .container {
    max-width: 900px;
    margin: auto;
    padding: 20px;
  }

  .choice-buttons {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
    margin: 20px 0;
  }

  .choice-buttons button {
    padding: 20px 40px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-size: 1.2em;
    font-weight: bold;
    transition: background 0.3s;
  }

  .concert { background-color: #4da6ff; color: #0d0d0d; }
  .worship { background-color: #ffcc66; color: #0d0d0d; }

  .concert:hover { background-color: #66b3ff; }
  .worship:hover { background-color: #ffd27f; }

  input[type="text"] {
    width: 80%;
    padding: 10px;
    border-radius: 8px;
    border: none;
    margin: 10px auto;
    display: block;
    font-size: 1em;
  }

  .section {
    margin-top: 30px;
  }

  .section h2 {
    color: #a8a0ff;
    text-align: center;
  }

  .dropzone {
    background-color: #1b1b1b;
    border: 1px dashed #4da6ff;
    border-radius: 8px;
    padding: 10px;
    min-height: 60px;
    margin: 10px 0;
  }

  .song {
    background-color: #242424;
    border-radius: 6px;
    padding: 8px 10px;
    margin: 5px 0;
  }

  .summary {
    text-align: center;
    margin-top: 20px;
    color: #ffcc66;
    font-weight: 500;
  }

  .bottom-buttons {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
    margin-top: 20px;
  }

  button.action {
    padding: 10px 20px;
    border-radius: 6px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    font-size: 1em;
    width: 80%;
    max-width: 300px;
  }

  button.primary { background-color: #4da6ff; color: #0d0d0d; }
  button.danger { background-color: #ff4d4d; color: white; }

  button.primary:hover { background-color: #66b3ff; }
  button.danger:hover { background-color: #ff6666; }

  @media (max-width: 768px) {
    .choice-buttons button {
      width: 90%;
    }
  }
</style>
</head>
<body>

<div class="logo-header">
  <img src="https://drive.google.com/thumbnail?id=1aaPOxP4OkfsfMd8t3QcSAI5TIx5YN4pl&sz=800" alt="Keleti Reform Logo">
  <h1>Esem√©nytervez≈ë</h1>
</div>

<div class="container">
  <input type="text" id="eventName" placeholder="Esem√©ny neve (pl. Vas√°rnapi Istentisztelet)">

  <div class="choice-buttons">
    <button class="concert" id="chooseConcert">üé§ Koncert</button>
    <button class="worship" id="chooseWorship">‚õ™ Istentisztelet</button>
  </div>

  <div id="sections"></div>

  <div class="summary" id="summary">√ñsszesen: 0 dal, 0:00</div>

  <div class="bottom-buttons">
    <button class="primary action" id="share">üì§ Megoszt√°s / M√°sol√°s</button>
    <button class="primary action" onclick="window.print()">üñ®Ô∏è Nyomtat√°s</button>
    <button class="danger action" onclick="window.location.href='index.html'">‚¨ÖÔ∏è Vissza</button>
  </div>
</div>

<script>
const sectionsDiv = document.getElementById('sections');
const summaryDiv = document.getElementById('summary');
let setlist = JSON.parse(localStorage.getItem('finalSetlist')) || { songs: [] };
let mode = null;

function renderSongs(container, filterFn) {
  const songs = setlist.songs.filter(filterFn || (() => true));
  container.innerHTML = songs.map(s => `<div class="song">${s}</div>`).join('');
}

function updateSummary() {
  const total = setlist.totalCount || 0;
  const time = setlist.totalTime || '0:00';
  summaryDiv.innerText = `√ñsszesen: ${total} dal, ${time}`;
}

document.getElementById('chooseConcert').addEventListener('click', () => {
  mode = 'concert';
  sectionsDiv.innerHTML = `
    <div class="section">
      <h2>üé§ Koncert dalai</h2>
      <div class="dropzone" id="concertList"></div>
    </div>`;
  renderSongs(document.getElementById('concertList'));
  updateSummary();
});

document.getElementById('chooseWorship').addEventListener('click', () => {
  mode = 'worship';
  const categories = [
    { id: 'gyelekezo', name: 'Gy√ºlekez≈ë √©nek' },
    { id: 'kezdo', name: 'Kezd≈ë √©nek' },
    { id: 'fennallo', name: 'Fenn√°ll√≥ √©nek' },
    { id: 'rafelelo', name: 'R√°felel≈ë √©nek' },
    { id: 'zaro', name: 'Z√°r√≥√©nek' }
  ];
  sectionsDiv.innerHTML = categories.map(cat => `
    <div class="section">
      <h2>${cat.name}</h2>
      <div class="dropzone" id="${cat.id}"></div>
    </div>`).join('');
  renderSongs(document.getElementById('gyelekezo'));
  updateSummary();
});

document.getElementById('share').addEventListener('click', async () => {
  const name = document.getElementById('eventName').value || 'Esem√©ny';
  const text = `üìú ${name}\nT√≠pus: ${mode === 'concert' ? 'Koncert' : 'Istentisztelet'}\n\n` +
    setlist.songs.join('\n') + 
    `\n\nüìä √ñsszesen: ${setlist.totalCount} dal, ${setlist.totalTime}`;

  if (navigator.share) {
    try {
      await navigator.share({ title: name, text });
    } catch (e) {
      console.error('Megoszt√°s megszak√≠tva', e);
    }
  } else {
    await navigator.clipboard.writeText(text);
    alert('‚úÖ A terv v√°g√≥lapra m√°solva!');
  }
});

updateSummary();
</script>

</body>
</html>
